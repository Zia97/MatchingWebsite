<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">

  <script type='text/javascript' src='http://code.jquery.com/jquery-1.8.2.js'></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.1.0.min.js"></script>

</head>

<body>
  <h1> Home Page </h1>
  {% if user.is_authenticated %}

    <script type="text/javascript">
    $(document).ready(function() {
      $.ajax(
        {
          url: 'users',
          type: 'get',
          success: function(data) {

            for (var i = 0; i < data.UserProfile.length; i++) {
              var respId = data.UserProfile[i].id;
              var username = data.UserProfile[i].username;

              if(username == '{{user.username}}')
              {
                console.log(respId);
                addEntry(respId, data.UserProfile[i].username ,data.UserProfile[i].first_name, data.UserProfile[i].last_name, data.UserProfile[i].dob, data.UserProfile[i].email, data.UserProfile[i].gender, data.UserProfile[i].image, data.UserProfile[i].hobUser);
              }
            };
          },
          failure: function(data) {
            alert('error');
          }
        }
      )
    })
  </script>

<script type="text/javascript">
  function addEntry(id, username, first_name, last_name, dob, email, gender, image, hobbies) {
      $('#userInfo').append('<br/>')

      $('#userInfo').append('<div id="userId' + id + '" ><h3> <ul><li>DOB:' + username + " " + first_name + " " + last_name + " " + dob + " " +email + " " + gender + " "+ image)

      if(hobbies==null)
      {
        console.log("hobbies is null")
      }

      var keys = Object.keys(hobbies);

      for (var i = 0, len = keys.length; i < len; i++)
      {
          $('#userInfo').append(keys[i])
      }
    }
    </script>


  <!-- <script type="text/javascript">
  function addProduct() {

      //var productPrice = document.getElementById('pricefieldform').value
      //var productName = document.getElementById('namefieldform').value
      var productDescription = document.getElementById('descriptionfieldform').value

      $.ajax({
        type: 'POST',
        url: 'product/',
        data: {
          "name": productName,
          "price": productPrice,
          "description": productDescription

        },
        dataType: 'json',
        success: function(response) {

          var respId = response.id;
          addEntry(respId, response.name, response.description, response.price);

        },
        error: function(reg, status, error) {
          alert(status.text);
        }
      });
    }
  </script> -->

  <span id="userInfo" style="font-weight:bold">User Info</span>

    {% else %}
    <h2> You are not logged in.</h2>
  {% endif %}
  <form action ="{% url 'logout' %}" enctype="multipart/form-data">

    <p><input  style="height:50px;width:200px" type = "submit" value = "Logout"> </p>
  </form>
  </body>
</html>
